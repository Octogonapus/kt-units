# kt-units

[![Build Status](https://travis-ci.org/Octogonapus/kt-units.svg?branch=master)](https://travis-ci.org/Octogonapus/kt-units)
[![Build status](https://ci.appveyor.com/api/projects/status/ejcuomseklhxej3y?svg=true)](https://ci.appveyor.com/project/Octogonapus/kt-units)
[![Download](https://api.bintray.com/packages/octogonapus/maven-artifacts/kt-units/images/download.svg) ](https://bintray.com/octogonapus/maven-artifacts/kt-units/_latestVersion)
[![codecov](https://codecov.io/gh/Octogonapus/kt-units/branch/master/graph/badge.svg)](https://codecov.io/gh/Octogonapus/kt-units)
[![stability-experimental](https://img.shields.io/badge/stability-experimental-orange.svg)](https://github.com/emersion/stability-badges#experimental)
[![License: LGPL-3.0](https://img.shields.io/github/license/Octogonapus/kt-units.svg)](https://img.shields.io/github/license/Octogonapus/kt-units.svg)

Unit conversions and dimensional analysis for Kotlin.

Goals of this project:
 - Fast conversions and dimensional analysis
 - Minimal, simple, and easy to use API

Non-goals of this project:
 - Support for every scientifically significant unit or conversion
 - Arbitrary precision

## Example Code

Convert between units of the same dimension:
```kotlin
val meters: Double = 2.inch.meter      // 0.0508 meters
val pounds: Double = 3.7.newton.lbF    // 0.83 pounds (force)
```

Add and subtract units of the same dimension:
```kotlin
val mass: Mass = 1.kilogram + 200.gram         // 1.2 kilograms
val time: Time = 1.second - 200.millisecond    // 0.8 seconds
```

Multiply and divide units of (possibly) differing dimensions:
```kotlin
val velocity: Velocity = 4.foot / 0.5.second    // 8.0 feet per second
val pressure: Pressure = 2.newton / 10.sqInch   // 309.98 pascal
```

Use familiar math functions:
```kotlin
val distance: Length = (1.inch.squared() + 3.inch.squared()).sqrt()  // 3.16 inches
val sinLength: Double = (PI / 2).meter.sin()  // 1.0
val volume: Volume = 2.inch.cubed()           // 8 cubic inches
```

## What about units with arbitrary dimensions?

All units inherit from `Quantity`, so math with units of arbitrary dimensions is possible:
```kotlin
val quantity1 = Quantity(1, 0, -2, 3, 2.0)
val quantity2 = Quantity(2, 3, -4, 0, 6.0)
val product = quantity1 * quantity2
// Quantity(massDim=3, lengthDim=3, timeDim=-6, angleDim=3, value=12.0)
```

Some dimensions-sensitive operations, such as addition and subtraction, will throw an
`UnsupportedOperationException` if their requirements are not met:
```kotlin
val quantity1 = Quantity(1, 0, -2, 3, 2.0)
val quantity2 = Quantity(2, 3, -4, 0, 6.0)
val sum = quantity1 + quantity2
// java.lang.UnsupportedOperationException: Cannot add quantities with unequal dimensions:
// Quantity(massDim=1, lengthDim=0, timeDim=-2, angleDim=3, value=2.0)
// Quantity(massDim=2, lengthDim=3, timeDim=-4, angleDim=0, value=6.0)

val sum = 1.meter + 3.second // Compiler error, unless the above plus operator is imported
```

## Can I make my own units?

Yes. All included units are (almost) entirely autogenerated using an annotation processor in the
`processor` module. For example, here is the actual definition of `Pressure`:
```kotlin
@QuantityType(1, -1, -2, 0)
@QuantityConversions(
    QuantityConversion("pascal", 1.0),
    QuantityConversion("bar", 1e+5),
    QuantityConversion("lbFin", 6894.757293168)
)
data class Pressure(
    override val value: Double
) : Quantity(1, -1, -2, 0, value)
```

`QuantityType` is required for the annotation processor to understand the dimensions of the unit.
Then, optionally, for each desired conversion property (e.g., `1.pascal`, `myPressure.bar`, etc.)
a `QuantityConversion` is defined specifying the name of the conversion and the ratio of
"unconverted" units to SI units (e.g., `1 bar` is equivalent to `1e+5 pascal`).
